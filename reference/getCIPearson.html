<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Function to return parametric CI around observed Pearson correlation — getCIPearson • CECPfuns</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Function to return parametric CI around observed Pearson correlation — getCIPearson"><meta name="description" content="Function to return parametric CI around observed Pearson correlation"><meta property="og:description" content="Function to return parametric CI around observed Pearson correlation"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CECPfuns</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9052</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Background.html">Background</a></li>
    <li><a class="dropdown-item" href="../articles/Bootstrapping.html">Bootstrapping</a></li>
    <li><a class="dropdown-item" href="../articles/Introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/RCSC_framework.html">RCSC_framework</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Function to return parametric CI around observed Pearson correlation</h1>

      <div class="d-none name"><code>getCIPearson.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function to return parametric CI around observed Pearson correlation</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">getCIPearson</span><span class="op">(</span><span class="va">r</span>, <span class="va">n</span>, ci <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-r">r<a class="anchor" aria-label="anchor" href="#arg-r"></a></dt>
<dd><p>numeric: the observed correlation -1 &lt;= r &lt;= 1</p></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>numeric: integer count of observations in the data</p></dd>


<dt id="arg-ci">ci<a class="anchor" aria-label="anchor" href="#arg-ci"></a></dt>
<dd><p>numeric: confidence interval required, defaults to .95</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A named vector LCL and UCL</p>
    </div>
    <div class="section level2">
    <h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a></h2>


<p>This is very simple function to return the confidence limits of the confidence interval
around an observed Pearson correlation given the number of observations in the dataset (n)
and the confidence interval required (ci, defaults to .95).  The maths go back for ever.
I suspect that my first version of this function, written for S+ not R, was probably drawing
on Altman, D. G., &amp; Gardner, M. J. (1988). Calculating confidence intervals for regression
and correlation. British Medical Journal, 296, 1238–1242.
The confidence interval is based on the Gaussian distribution model for both variables so if
you have the raw data it's almost certainly better to use the bootstrap confidence interval
which is provided by getBootCICorr() in this package.  This is probably mainly useful when
you read a Pearson correlation value in some report, with the n on which it was derived but
the report doesn't give a CI and you want to have a sense of that CI to have a sense of the
precision of estimation there for comparing that correlation with others, perhaps your own
from your own data.</p>
<p>The function just returns a named vector of the LCL and UCL which should help using it in
tidyverse pipes.  See examples.</p>
<p>For perfect observed correlations, i.e. R = +1.0 or -1.0 the function returns c(1, 1) or
c(-1, -1). This may feel slightly counterintuitive as you might expect the intervals to
be c(something, 1) and c(-1, something) respectively on the logic that if you added one
more pair of values such that the correlation would no longer be perfect the computed CI
ought to reflect that (hence my "something" above!)  However, the reality is that if the
observed correlation really was perfect there is no way given the data to compute a
sensible lower bound (for observed R = 1.0, upper bound for observed R = -1).  Returning
c(1, 1) for perfect positive correlation and c(-1, -1) for perfect negative correlation
is the only sensible option and is in line with stats::cor.test().</p>
    </div>
    <div class="section level2">
    <h2 id="history-development-log">History/development log<a class="anchor" aria-label="anchor" href="#history-development-log"></a></h2>


<p>Version 1: 25.xi.23</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other confidence interval functions:
<code><a href="getCISpearman.html">getCISpearman</a>()</code>,
<code><a href="plotBinconf.html">plotBinconf</a>()</code>,
<code><a href="plotCIPearson.html">plotCIPearson</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Chris Evans</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co">### this is a trivial example of the impact of sample size!</span></span></span>
<span class="r-in"><span><span class="fu">getCIPearson</span><span class="op">(</span><span class="fl">.7</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#      LCL       UCL</span></span></span>
<span class="r-in"><span><span class="co"># 0.1258332 0.9228784</span></span></span>
<span class="r-in"><span><span class="fu">getCIPearson</span><span class="op">(</span><span class="fl">.7</span>, <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># LCL       UCL</span></span></span>
<span class="r-in"><span><span class="co"># 0.5838581 0.7880650</span></span></span>
<span class="r-in"><span><span class="fu">getCIPearson</span><span class="op">(</span><span class="fl">.7</span>, <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># LCL       UCL</span></span></span>
<span class="r-in"><span><span class="co"># 0.6669493 0.7303015</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### This illustrates the handling of a perfect correlation</span></span></span>
<span class="r-in"><span><span class="fu">getCIPearson</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># LCL UCL</span></span></span>
<span class="r-in"><span><span class="co"># 1   1</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### this is an example of how the function can be used in a tidyverse pipe</span></span></span>
<span class="r-in"><span><span class="fu">tibble</span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># column of data sizesx = rnorm(n))</span></span></span>
<span class="r-in"><span>   <span class="co">### now create some raw data of varying degrees of correlation</span></span></span>
<span class="r-in"><span>   <span class="fu">mutate</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   y <span class="op">=</span> <span class="va">x</span> <span class="op">+</span> <span class="fl">2</span>, <span class="co"># perfectly correlated</span></span></span>
<span class="r-in"><span>   z0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, <span class="co"># get uncorrelated y</span></span></span>
<span class="r-in"><span>   z1 <span class="op">=</span> <span class="va">x</span> <span class="op">+</span> <span class="fl">10</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, <span class="co"># create weakly correlated values</span></span></span>
<span class="r-in"><span>   <span class="co">### and now much more strongly correlated values</span></span></span>
<span class="r-in"><span>   z2 <span class="op">=</span> <span class="va">x</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">tmpTib</span></span></span>
<span class="r-in"><span><span class="va">tmpTib</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">tmpTib</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">summarise</span><span class="op">(</span>n <span class="op">=</span> <span class="fu">first</span><span class="op">(</span><span class="va">n</span><span class="op">)</span>, <span class="co"># keep n</span></span></span>
<span class="r-in"><span>            R1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span>, <span class="co"># first correlation (perfect)</span></span></span>
<span class="r-in"><span>            R2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">z0</span><span class="op">)</span>, <span class="co"># next (random)</span></span></span>
<span class="r-in"><span>            R3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">z1</span><span class="op">)</span>, <span class="co"># next (weak correlation)</span></span></span>
<span class="r-in"><span>            <span class="co">### and finally: strong correlation</span></span></span>
<span class="r-in"><span>            R4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">z2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">pivot_longer</span><span class="op">(</span>cols <span class="op">=</span> <span class="va">R1</span> <span class="op">:</span> <span class="va">R4</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">tmpTib</span></span></span>
<span class="r-in"><span><span class="va">tmpTib</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### now use getCIPearson() in a dplyr/tidverse pipe</span></span></span>
<span class="r-in"><span><span class="va">tmpTib</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">name</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># as we want the CIs for each of those correlations</span></span></span>
<span class="r-in"><span>  <span class="fu">mutate</span><span class="op">(</span>CIPearson <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">getCIPearson</span><span class="op">(</span><span class="va">value</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># use list() as getCIPearson retuns a vector</span></span></span>
<span class="r-in"><span>  <span class="co">### can now unnest the returned values to see them</span></span></span>
<span class="r-in"><span>  <span class="fu">unnest_wider</span><span class="op">(</span><span class="va">CIPearson</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">### in real life groups by gender or other demographics and say correlating CORE scores</span></span></span>
<span class="r-in"><span><span class="co">### against number of children might be sensible examples of doing this</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Chris Evans.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>


<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Function offering four methods to find the CI around an observed Spearman correlation — getCISpearman • CECPfuns</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Function offering four methods to find the CI around an observed Spearman correlation — getCISpearman"><meta property="og:description" content="Function offering four methods to find the CI around an observed Spearman correlation"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CECPfuns</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9041</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Background.html">Background</a>
    </li>
    <li>
      <a href="../articles/Bootstrapping.html">Bootstrapping</a>
    </li>
    <li>
      <a href="../articles/Introduction.html">Introduction</a>
    </li>
    <li>
      <a href="../articles/RCSC_framework.html">RCSC_framework</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Function offering four methods to find the CI around an observed Spearman correlation</h1>
    
    <div class="hidden name"><code>getCISpearman.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function offering four methods to find the CI around an observed Spearman correlation</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">getCISpearman</span><span class="op">(</span><span class="va">rs</span>, <span class="va">n</span>, ci <span class="op">=</span> <span class="fl">0.95</span>, Gaussian <span class="op">=</span> <span class="cn">FALSE</span>, FHP <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>rs</dt>
<dd><p>numeric: the observed Spearman correlation</p></dd>


<dt>n</dt>
<dd><p>numeric: the number of (paired) values for the correlation</p></dd>


<dt>ci</dt>
<dd><p>numeric: the confidence interval you want, default .95, i.e. 95%</p></dd>


<dt>Gaussian</dt>
<dd><p>logical: use the Gaussian lookup for the CI, defaults to FALSE</p></dd>


<dt>FHP</dt>
<dd><p>logical: use the Fieller, Hartley &amp; Pearson (1957) method, defaults to FALSE</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A named vector LCL and UCL</p>
    </div>
    <div id="background">
    <h2>Background</h2>
    

<p>This is very simple function to return the confidence limits of the confidence interval
around an observed Pearson correlation given the number of observations in the dataset (n)
and the confidence interval required (ci, defaults to .95).  There are four methods obtained
by using either the Bonett &amp; White (2000) approximation to the SE of the correlation or the
the Fieller, Hartley &amp; Pearson (1957) approximation and combining those with either looking
up the value of the Gaussian to get the desired CI coverage or using the value of the
t distribution with df = n - 2.  It is known that none of the methods work well, i.e. give
coverage matching that desired and without bias, when the n is below 25 and/or the absolute
population Spearman correlation is above .95 so use with caution if n &lt; 25 and observed
correlation &gt; .90.</p>
<p>The function just returns a named vector of the LCL and UCL which should help using it in
tidyverse pipes.  See examples.</p>
<p>There is more information about the function in my <a href="https://www.psyctc.org/Rblog/" class="external-link">Rblog</a> at
<a href="https://www.psyctc.org/Rblog/posts/2023-11-27-cispearman/" class="external-link">Confidence interval around Spearman correlation coefficient</a>.</p>
<p>There is also a shiny app using this function at
<a href="https://shiny.psyctc.org/apps/CISpearman/" class="external-link">https://shiny.psyctc.org/apps/CISpearman/</a></p>
    </div>
    <div id="references-acknowledgements">
    <h2>References/acknowledgements</h2>
    


<ol><li><p>This started from finding the excellent answers from <code>onestop</code> <a href="https://stats.stackexchange.com/users/449/onestop" class="external-link">https://stats.stackexchange.com/users/449/onestop</a>
and <code>retodomax</code> <a href="https://stats.stackexchange.com/users/237402/retodomax" class="external-link">https://stats.stackexchange.com/users/237402/retodomax</a>
to the question on  <a href="https://stats.stackexchange.com/" class="external-link">CrossValidated</a>
specifically <a href="https://stats.stackexchange.com/questions/18887/how-to-calculate-a-confidence-interval-for-spearmans-rank-correlation" class="external-link">How to calculate a confidence interval for Spearman's rank correlation?</a>
Also, as referenced in that page ...</p></li>
<li><p>Bishara, A. J., &amp; Hittner, J. B. (2017). Confidence intervals for correlations when data are not normal. Behavior Research Methods, 49(1),
294–309. <a href="https://doi.org/10.3758/s13428-016-0702-8" class="external-link">https://doi.org/10.3758/s13428-016-0702-8</a>
gives extensive simulation work covering much more than these CIs.
I checked my code against the results from the R code given in Supplement A to that paper.  Then ...</p></li>
<li><p>Bonett, D. G., &amp; Wright, T. A. (2000). Sample size requirements for estimating pearson, kendall and spearman correlations.
Psychometrika, 65(1), 23–28. <a href="https://doi.org/10.1007/BF02294183" class="external-link">https://doi.org/10.1007/BF02294183</a> is a classic (interesting to see how typesetting of equations
has improved since 2000!) and ...</p></li>
<li><p>Ruscio, J. (2008). Constructing Confidence Intervals for Spearman’s Rank Correlation with Ordinal Data:
A Simulation Study Comparing Analytic and Bootstrap Methods. Journal of Modern Applied Statistical Methods,
7(2), 416–434. <a href="https://doi.org/10.22237/jmasm/1225512360" class="external-link">https://doi.org/10.22237/jmasm/1225512360</a> was another excellent paper on the topic.</p></li>
</ol><p>Thanks to all those authors.</p>
    </div>
    <div id="history-development-log">
    <h2>History/development log</h2>
    

<p>Version 1: 27.xi.23</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other confidence interval functions: 
<code><a href="getCIPearson.html">getCIPearson</a>()</code>,
<code><a href="plotBinconf.html">plotBinconf</a>()</code>,
<code><a href="plotCIPearson.html">plotCIPearson</a>()</code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Chris Evans</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu">getCISpearman</span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># LCL       UCL</span></span></span>
<span class="r-in"><span><span class="co"># 0.2338274 0.6964523</span></span></span>
<span class="r-in"><span><span class="fu">getCISpearman</span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">50</span>, Gaussian <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># LCL       UCL</span></span></span>
<span class="r-in"><span><span class="co"># 0.2412245 0.6923933</span></span></span>
<span class="r-in"><span><span class="fu">getCISpearman</span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">50</span>, Gaussian <span class="op">=</span> <span class="cn">TRUE</span>, FHP <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># LCL       UCL</span></span></span>
<span class="r-in"><span><span class="co"># 0.2495794 0.6877365</span></span></span>
<span class="r-in"><span><span class="fu">getCISpearman</span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">50</span>, Gaussian <span class="op">=</span> <span class="cn">FALSE</span>, FHP <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># LCL       UCL</span></span></span>
<span class="r-in"><span><span class="co"># 0.2424304 0.6917259</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### imaginary correlations of CORE-OM scores against number of children by parental gender</span></span></span>
<span class="r-in"><span><span class="co">### create a tibble of the imaginary data</span></span></span>
<span class="r-in"><span><span class="fu">tribble</span><span class="op">(</span><span class="op">~</span><span class="va">pGender</span>, <span class="op">~</span><span class="va">rs</span>, <span class="op">~</span><span class="va">n</span>,</span></span>
<span class="r-in"><span>        <span class="st">"M"</span>, <span class="fl">.12</span>, <span class="fl">643</span>,</span></span>
<span class="r-in"><span>        <span class="st">"F"</span>, <span class="fl">.57</span>, <span class="fl">808</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">tibDat</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### check it</span></span></span>
<span class="r-in"><span><span class="va">tibDat</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### use it</span></span></span>
<span class="r-in"><span><span class="va">tibDat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">rowwise</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="co">### need to use list() as we're getting a vector</span></span></span>
<span class="r-in"><span>  <span class="co">### using the default arguments for getCISpearman()</span></span></span>
<span class="r-in"><span>  <span class="fu">mutate</span><span class="op">(</span>CISpearman <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">getCISpearman</span><span class="op">(</span><span class="va">rs</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="co">### now get the values from the vectors</span></span></span>
<span class="r-in"><span>  <span class="fu">unnest_wider</span><span class="op">(</span><span class="va">CISpearman</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># # A tibble: 2 × 5</span></span></span>
<span class="r-in"><span><span class="co"># pGender    rs     n    LCL   UCL</span></span></span>
<span class="r-in"><span><span class="co"># &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;</span></span></span>
<span class="r-in"><span><span class="co"># 1 M        0.12   643 0.0427 0.196</span></span></span>
<span class="r-in"><span><span class="co"># 2 F        0.57   808 0.518  0.618</span></span></span>
<span class="r-in"><span><span class="co">### pretty clear that the correlation for the women is very different</span></span></span>
<span class="r-in"><span><span class="co">### from that for the men</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Chris Evans.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

